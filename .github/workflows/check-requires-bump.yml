name: Check Requires Bump

on: 
  pull_request:
    branches: [ "main", "0.2.x", "0.1.x" ]
    paths:
      - 'cassini/*'
      - 'tests/*'
      - 'pyproject.toml'
      
permissions:
  contents: read

jobs:
  check:

    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
      with:
        fetch-depth: 0
    - name: check version bumped
      shell: bash
      run: |
        CURRENT_CONTENT=$(git show origin/${{ github.base_ref }}:pyproject.toml)
        echo $CURRENT_CONTENT
        CURRENT_VERSION=$(echo $CURRENT_CONTENT | grep -E ^version || true)
        echo $CURRENT_VERSION
        THIS_VERSION=$(git show HEAD:pyproject.toml | grep -E ^version || true)
        echo $THIS_VERSION
        
        if [ "$CURRENT_VERSION" == "$THIS_VERSION" ]; then
          echo "Bump required
          exit 1
        
      

    
